<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>○○○○</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }
        .markers {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        .marker {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: red; /* 初期色は赤 */
            transition: background-color 0.5s;
        }
        .blue {
            background-color: green; /* アクセス時の色は緑 */
        }
        #hiddenLink {
            display: none;
            margin-top: 20px;
            font-size: 18px;
            color: green;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <h1></h1>
    <p><span id="accessedLink"></span>からアクセスしました</p>
    
    <div class="markers">
        <div id="marker1" class="marker"></div>
        <div id="marker2" class="marker"></div>
        <div id="marker3" class="marker"></div>
        <div id="marker4" class="marker"></div>
    </div>
    
    <a id="hiddenLink" href="https://line.me/R/oaMessage/%40778unfqy/%E5%85%A8%E3%81%A6%E3%81%AE%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E8%A6%8B%E3%81%A4%E3%81%91%E3%81%BE%E3%81%97%E3%81%9F">全てのアクセスポイントにたどり着きました</a>

    <script>
        // URLパラメータを取得する関数
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // リンク番号とページ名のマッピング
        const linkNames = {
            "1": "♣",
            "2": "♠",
            "3": "♦",
            "4": "♥"
        };

        // アクセスされたリンク番号を取得
        const linkNumber = getQueryParam('link');
        const accessedLinkName = linkNumber && linkNames[linkNumber] ? linkNames[linkNumber] : '不明';
        document.getElementById('accessedLink').textContent = accessedLinkName;

        // マーカーの色を更新する関数
        function updateMarker(num) {
            const marker = document.getElementById(`marker${num}`);
            if (marker) {
                marker.classList.add('blue');
            }
        }

        // すべてのリンクがアクセスされたかをチェックする関数
        function allLinksAccessed() {
            const accessedLinks = JSON.parse(localStorage.getItem('accessedLinks')) || [];
            return [1, 2, 3, 4].every(num => accessedLinks.includes(num.toString()));
        }

        // localStorageからアクセス状態を取得・更新
        if (linkNumber) {
            // 既にアクセスしたか確認
            let accessedLinks = JSON.parse(localStorage.getItem('accessedLinks')) || [];

            if (!accessedLinks.includes(linkNumber)) {
                accessedLinks.push(linkNumber);
                localStorage.setItem('accessedLinks', JSON.stringify(accessedLinks));
            }

            // マーカーを更新
            updateMarker(linkNumber);
        }

        // ページ読み込み時にマーカーを表示状態にし、非表示リンクを制御
        window.onload = function() {
            const accessedLinks = JSON.parse(localStorage.getItem('accessedLinks')) || [];
            accessedLinks.forEach(num => {
                updateMarker(num);
            });

            // すべてのリンクがアクセスされた場合に非表示リンクを表示
            if (allLinksAccessed()) {
                const hiddenLink = document.getElementById('hiddenLink');
                hiddenLink.style.display = 'inline';
                hiddenLink.textContent = 'こちらをタップしてください';
                hiddenLink.href = 'https://line.me/R/oaMessage/%40778unfqy/%E5%85%A8%E3%81%A6%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AB%E3%81%9F%E3%81%A9%E3%82%8A%E7%9D%80%E3%81%8D%E3%81%BE%E3%81%97%E3%81%9F';
            }
        }
    </script>
</body> 
</html>
